<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" type="text/css" href="http://blog.dasroot.net/theme/css/semantic.min.css">
  <link rel="stylesheet" type="text/css" href="http://blog.dasroot.net/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="http://blog.dasroot.net/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>


  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Charles Butler">
  <meta name="description" content="Posts and writings by Charles Butler">

  <link href="http://blog.dasroot.net/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Chuck@Home Atom" />
<meta name="keywords" content="untagged">

  <title>
    Chuck@Home
&ndash; Doing it right with S3  </title>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29116636-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>

<body>
  <aside>
    <div id="user_meta">
      <a href="http://blog.dasroot.net">
        <img src="http://www.gravatar.com/avatar/78270a8df5051560ab56ad16bc4724a3.png?s=200" alt="Chuck@home" class="ui medium circular image">
      </a>
      <h2><a href="http://blog.dasroot.net">Chuck@Home</a></h2>
      <p>juju deploy happiness</p>
      <ul>
        <li><a href="http://charlesbutler.me/" target="_blank">About Chuck</a></li>
        <li><a href="http://blog.juju.solutions/" target="_blank">My GPG Key</a></li>
        <li><a href="http://blog.dasroot.net/archives" target="_blank">Archives</a></li>
        <li><a href="http://github.com/chuckbutler" target="_blank">Github</a></li>
        <li><a href="http://twitter.com/lazypower" target="_blank">Twitter</a></li>
        <li><a href="https://plus.google.com/+CharlesButlertheNinja" target="_blank">Google+</a></li>
      </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="http://blog.dasroot.net">Index</a> &brvbar; <a href="http://blog.dasroot.net/archives.html">Archives</a>
      &brvbar; <a href="http://blog.dasroot.net/feeds/all.atom.xml">Atom</a>
      </p>
    </header>

<article>
  <div class="article_title">
    <h3><a href="http://blog.dasroot.net/doing-it-right-with-s3.html">Doing it right with S3</a></h3>
  </div>
  <div class="article_text">
    <hr />
<p>As some of you know, I'm an avid follower of the brilliant people at <a href="http://www.askubuntu.com">Ask Ubuntu</a> and <a href="http://www.jorgecastro.org">Jorge Castro</a> had an extremely excellent idea of hosting his <a href="http://www.octopress.org">Octopress</a> blog out of AWS S3. This got me thinking - I'm paying upwards of $60 USD a month for hosting through Linode, and since I cut the Wordpress habit next to none of my projects require server side includes, so this was literally money down the chute.</p>
<p>Hosting my static sites, for example the vcard you see at the footer of my blog, would be an excellent place to start. Move this puppy over to S3, pilot the difficulty rating of just how hard it is and move forward with an execution of the rest of my pages. (Also, we can thank the fine people over at <a href="http://www.github.com">GitHub</a> for powering this blog instance.)</p>
<!-- more -->

<p><img src="http://profile.ak.fbcdn.net/hprofile-ak-snc4/41793_290917647635382_811386155_q.jpg" alt="Challenge Accepted" style="float: left;"></p>
<p>Since I have nearly no experience in working with AWS from a linux box, this was one of those moments where I knew it was time to tug on my bootstraps and learn something new.</p>
<p>My first task was to figure out just how I was going to interface with an S3 bucket on Ubuntu. A quick google search yielded s3cmd. This command line tool affords you loads of flexibility, and you guessed it, I can script an entire site deployment with this handy utility. Why thank you CLI programmers of the universe. You give me warm and fuzzy feelings all over. </p>
<h4>Great, I have the technology, now what?</h4>
<p>If you dont currently have an AWS account you'll need to sign up for one.</p>
<p>Import your S3 Credentials into s3cmd as follows</p>
<div class="highlight"><pre><span class="n">s3cmd</span> <span class="o">--</span><span class="n">configure</span>
</pre></div>


<p>s3cmd will prompt you for your AWS public and private keys. Ask about SSL encryption for data transfer settings and boom you're ready to start using s3cmd. </p>
<div class="highlight"><pre><span class="nx">s3cmd</span> <span class="nx">mb</span> <span class="nx">s3</span><span class="p">:</span><span class="c1">//&lt;yourbucketname&gt;</span>
</pre></div>


<p>This will create your s3 bucket, basically just alotting a bin for you to start placing files. With the bucket created, you should enable serving of web-content from the bin - set the index document, and if you have an error page the optional error html. (this removes the AWS XML error page you'll get when users 404 your site structure) </p>
<p>I did that bit in the AWS management console itself - as depicted below.</p>
<p><img alt="AWS S3 Console" src="/img/aws-s3-console.png" /></p>
<p>With this step completed, you're free to upload your files. - One caveat that I discovered was if you dont implicitly define public Access, aws defaults to private ACL's. Read more on AWS S3 Access Control List (ACLs) <a href="http://aws.amazon.com/articles/5050">here</a></p>
<p>When pushing files to your S3 bucket, you can define the acl inline like so</p>
<div class="highlight"><pre><span class="nx">s3cmd</span> <span class="nx">put</span> <span class="o">--</span><span class="nx">acl</span><span class="na">-public</span> <span class="o">--</span><span class="nx">recursive</span> <span class="o">&lt;</span><span class="nx">directory</span><span class="o">&gt;</span> <span class="nx">s3</span><span class="p">:</span><span class="c1">//&lt;yourbucketname&gt;</span>
</pre></div>


<p>Hopefully with this short introduction, you have a good enough overview to start moving your flat files into S3. With some light reading, 20 minutes, and a new resolve to not be wasteful, we can all put money back in our pockets and save on energy costs by utilizing datacenters around the globe efficiently.</p>
  </div>
  <div class="article_meta">
    <p>Posted on: Tue 26 November 2013</p>
    <p>Category: <a href="http://blog.dasroot.net/category/misc.html">misc</a>
 &ndash; Tags:
      <a href="http://blog.dasroot.net/tag/untagged.html">untagged</a>    </p>
  </div>

  <div id="commentswrap">
      <div id="comments"></div>
  </div>
  
    <script src="https://apis.google.com/js/plusone.js"></script>
    <script>
        $(document).ready(function () {
            gapi.comments.render('comments', {
                href: window.location,
                width: '600',
                first_party_property: 'BLOGGER',
                view_type: 'FILTERED_POSTMOD'
            });
    });
    </script>



</article>


    <div id="ending_message">
      <p>&copy; Charles Butler. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Charles Butler on <a href="https://github.com/chuckbutler/pelican-svbremix" target="_blank">github</a>. Member of the <a href="http://internetdefenseleague.org">Internet Defense League</a>.</p>
    </div>
  </main>
<script type="text/javascript">
  window._idl = {};
  _idl.variant = "banner";
  (function() {
    var idl = document.createElement('script');
    idl.type = 'text/javascript';
    idl.async = true;
    idl.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'members.internetdefenseleague.org/include/?url=' + (_idl.url || '') + '&campaign=' + (_idl.campaign || '') + '&variant=' + (_idl.variant || 'banner');
    document.getElementsByTagName('body')[0].appendChild(idl);
  })();
</script>
</body>
</html>